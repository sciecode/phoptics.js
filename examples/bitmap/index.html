<html>
  <head>
    <title>Phoptic.js - ImageBitmap for PNG is completely broken on the Web.</title>
    <style>
      html, body {
        margin: 0;
        background-color: #000;
      }

      .text {
        text-align: center;
        width: 100%;
        overflow: hidden;
        position: absolute;
        color: white;
        font-family: sans-serif;
        font-size: 12px;
        text-shadow: 1px 1px 2px black;
      }

      .info {
        font-size: 14px;
      }

      canvas {
        width: 100%;
        height: 80vh;
      }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.es5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/upng-js/2.1.0/UPNG.js"></script>
  </head>
  <body>
    <h3 id="message" class="text">
      Developers don't understand color theory.<br />
      As such, there isn't a way to correctly filter & composite (blend) .png ImageBitmaps on the web.<br />
      Either filtering, blending or premultiplied-alpha occurs in sRGB, leading to physically incorret output.<br />
      If you want physically correct filtering+blending, you need to generate png bitmap manually, decode sRGB & premultiply alpha youself.</h3>
    <img src="../textures/2px.png" style="height: 20vh; width: 100%">
    <h4 class="text info" style="top: 10vh">HTMLImageElement - default visualization.<br /> Filtering, Blending & PremultipliedAlpha in sRGB</h4>
    <h4 class="text info" style="top: 25vh">
      Bitmap - load bitmap from file, premultiply alpha on WebGPU texture upload (wrong - premultiplied-alpha in sRGB).<br /> 
      Texture format "unorm-srgb" to decode before filtering.<br />
      PremultipliedAlpha in sRGB</h4>
    <h4 class="text info" style="top: 45vh">
      Bitmap - load bitmap from file, don't premultiply alpha before WebGPU texture upload.<br />
      Texture format "unorm-srgb" to decode before filtering.<br />
      No premultipliedAlpha applied - leads to incorrect compositing during filtering.
    </h4>
    <h4 class="text info" style="top: 65vh">Manually decode .PNG file - decode sRGB encoded png data to linear-srgb (use bigger precision)<br />
      PremultiplyAlpha (associative alpha) data array before uploading to "rgba32float" WebGPU texture. <br />
      Filtering, Blending & PremultipliedAlpha in linear-rgb</h4>
    <h4 class="text info" style="top: 87vh">Shader - Filtering & Blending & PremultipliedAlpha in linear-rgb</h4>
    <script type="module" src="index.js"></script>
  </body>
</html>